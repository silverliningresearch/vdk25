<!DOCTYPE html>
<html>
<head>
  <title>VDK TU 2025</title>
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
  <script src="scripts/PrepareData.js"></script>
  <script src="scripts/CalculateData.js"></script>
  <script type="text/javascript" src="https://silverliningresearch.github.io/daily_plan_data_sur_v3/BUD_Commercial/interview_statistics.js"></script> 

<style>
  
  /* h1 {text-align: center;}
  h2 {text-align: center;}
 */
.button {
  background-color: #4CAF50; /* Green */
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  width: 300px;
  margin: 4px 2px;
  cursor: pointer;
}

.red {background-color: #f44336;;} /* Red */
.blue {background-color: #0693e3;} /* Blue */ 

</style>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  function isNextDay()
  {
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);

    //?nextday=true
    return(urlParams.has('nextday'));
  }
  //google.charts.load('current', {'packages':['table']});
  google.charts.load('current', {'packages':['table','corechart', 'controls']});
  google.charts.setOnLoadCallback(drawTable);

  function drawTable() {
    //CalculateAirportAirLineReport();
    var data = new google.visualization.DataTable();

    data.addColumn('string', 'Time');
    data.addColumn('string', 'Flight');
    data.addColumn('string', 'To');
    data.addColumn('string', 'Schengen');
    //data.addColumn('string', 'DOOP');
    data.addColumn('number', 'Remaining Flights');
    data.addColumn('number', 'Quota');
    data.addColumn('number', 'Completed');
    data.addColumn('number', 'Missing');
    data.addColumn('number', 'Missing %');
    data.addColumn('number', 'Priority Score');
    data.addColumn('number', 'Priority');
    
    //add data
    for (i = 0; i < daily_plan_data.length; i++) {
      var row = daily_plan_data[i];
        { 
            data.addRows([[row.Date_Time, 
            row.Flight, row.DestName,  row.Schengen,
            //row.doop, 
            Number(row.remaining_flights), 
            Number(row.Quota), Number(row.Completed), Number(row.Difference), 
            Number(row.Difference_percent), 
            Number(row.Prioritisation_score), 
            Number(row.Priority)]]);
        }
      }

    //highlight priority one
    var priority_col = data.getNumberOfColumns()-1; //last one
    for (var i = 0; i < data.getNumberOfRows(); i++) {
      for (j=0; j < data.getNumberOfColumns(); j++) {
        if (data.getValue(i, priority_col) ==1) 
        {
          data.setProperty(i, j, 'style', 'background-color:#FFCCCB');
        }
        else {
          //data.setProperty(i, j, 'style', 'background-color:white; font-size: 15px');
        }
      }
    }

    //create a dashboard.
    var dashboard = new google.visualization.Dashboard(
    document.getElementById('dashboard_div'));

    //create fiter
    var options = {
      'filterColumnLabel': 'Schengen',
      "ui": {"label": "", 
            "labelStacking": 'horizotal',
            "caption": "Filter by Schengen/Non-Schengen",
            }
    };
    
    var tableFilter = new google.visualization.ControlWrapper({
      'controlType': 'CategoryFilter',
      'containerId': 'filter_div',
      'options': options
    });

    // Create table
    var tableChart = new google.visualization.ChartWrapper({
      'chartType': 'Table',
      'containerId': 'table_div',
      'options': {
        'allowHtml': true, 
        'cssClassNames': {tableCell: 'table-font', headerRow: 'table-font', headerCell: 'googleHeaderCell' },
        'sortColumn': 0, //time
        'showRowNumber': false, 'width': '100%', 'height': '100%'
      }
    });

    dashboard.bind(tableFilter, tableChart);

    var view = new google.visualization.DataView(data);
    view.hideColumns([priority_col, priority_col-1]); //hide priority one
    //document.getElementById("filter_div").style.display = "none";
    dashboard.draw(view);

     //overall_status
    var overall_status =  "Total quota: " + total_quota;
    overall_status += " - Total completed: " + total_completed + " (" + total_completed_percent + "%)";
    document.getElementById("overall_status").innerHTML =overall_status + " | " + "Data updated at " + download_time;
 }

function start_new_interview() {
 
  console.log("start_new_interview");
 
  let url = "https://silverliningresearch.github.io/BUD_Commercial/survey.html?";
  
  //
  if (flightForInterview && flightForInterview.Flight) url = url + "urlVar01=" + flightForInterview.Flight;
  if (flightForInterview && flightForInterview.DestName) url = url + "&urlVar02=" + flightForInterview.DestName;
  if (flightForInterview && flightForInterview.Dest) url = url + "&urlVar03=" + flightForInterview.Dest;
  if (flightForInterview && flightForInterview.Airline) url = url + "&urlVar04=" + flightForInterview.Airline;
  
  localStorage.clear();
  document.getElementById('inputFlightCodeID').value = "";
  window.location.href = url;
}


</script>
</head>
<body>

  <script>
    function start_new_interview() {
      console.log("start_new_interview");
      window.localStorage.clear();

      let url = "https://silverliningresearch.github.io/vdk25/survey.html";
      window.location.href = url;
    }

    function resume_curent_interview() {
      console.log("resume_curent_interview");
      let url = "https://silverliningresearch.github.io/vdk25/survey.html";
      window.location.href = url;
    }

</script>
  <!-- <h2>BER PASSENGER SURVEY</h2> -->
  </br>
  </br>
  <button onclick="start_new_interview()" class="button red">Start a new interview</button>
  <button onclick="resume_curent_interview()" class="button blue">Resume the current interview </button>

  <p>
	</br>
    *<strong>Resume the current interview</strong> will continue from the last question in the current interview.</br>
	</br></br></br>  
  </p>


  <div style="background-color: lightblue;">
  </br>
  </div> 
  
  <div id="dashboard_div">
    <!--Divs that will hold each control and chart-->
    <div id="filter_div" style="font-size: 15px"> </div>
      </br>
    <div id="table_div"></div>
  </div>

</body>
</html>


